# å¤šæ¨¡æ€Late Fusionæ¶ˆèå®éªŒç»“æœ

## æ¦‚è¿°

æœ¬æ–‡æ¡£å±•ç¤ºäº†åŸºäºè¶…å£°å›¾åƒçš„éª¨éª¼è‚Œå¹´é¾„é¢„æµ‹ä»»åŠ¡ä¸­ï¼Œ**å¤šæ¨¡æ€Late Fusion**æ¶æ„çš„ç»¼åˆæ¶ˆèå®éªŒç»“æœã€‚æˆ‘ä»¬ç³»ç»Ÿæ€§åœ°è¯„ä¼°äº†ä¸åŒè¾…åŠ©ç‰¹å¾ï¼ˆäººå£å­¦ç‰¹å¾å’Œå›¾åƒè¡ç”Ÿç‰¹å¾ï¼‰å¯¹é¢„æµ‹æ€§èƒ½çš„è´¡çŒ®ã€‚

## æ¨¡å‹æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å¤šæ¨¡æ€Late Fusionæ¶æ„                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   è¾“å…¥å›¾åƒ (224Ã—224Ã—3)              è¾…åŠ©ç‰¹å¾ (â‰¤6ç»´)                      â”‚
â”‚           â”‚                                  â”‚                          â”‚
â”‚           â–¼                                  â–¼                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚   â”‚   ResNet-50   â”‚                â”‚  Linear(dâ†’32)    â”‚                â”‚
â”‚   â”‚  (ImageNet    â”‚                â”‚  BatchNorm + ReLUâ”‚                â”‚
â”‚   â”‚   é¢„è®­ç»ƒ)     â”‚                â”‚  Dropout(0.36)   â”‚                â”‚
â”‚   â”‚  2048ç»´ç‰¹å¾   â”‚                â”‚  Linear(32â†’32)   â”‚                â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚  BatchNorm + ReLUâ”‚                â”‚
â”‚           â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚           â”‚                                 â”‚                          â”‚
â”‚           â”‚            32ç»´ç‰¹å¾             â”‚                          â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                          â”‚                                             â”‚
â”‚                          â–¼                                             â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚                  â”‚   ç‰¹å¾æ‹¼æ¥    â”‚                                     â”‚
â”‚                  â”‚  (2048+32)    â”‚                                     â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                          â”‚                                             â”‚
â”‚                          â–¼                                             â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚                  â”‚   èåˆå¤´      â”‚                                     â”‚
â”‚                  â”‚  2080â†’256â†’128 â”‚                                     â”‚
â”‚                  â”‚  + Dropout    â”‚                                     â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                          â”‚                                             â”‚
â”‚                          â–¼                                             â”‚
â”‚                      å¹´é¾„é¢„æµ‹                                           â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## è¾…åŠ©ç‰¹å¾è¯´æ˜

| ç‰¹å¾ | ç»´åº¦ | æ¥æº | æè¿° |
|------|------|------|------|
| **æ€§åˆ«** | 2 | Excelå…ƒæ•°æ® | One-hotç¼–ç  [ç”·, å¥³] |
| **BMI** | 1 | è®¡ç®—å¾—å‡º | ä½“è´¨æŒ‡æ•°ï¼Œz-scoreæ ‡å‡†åŒ– |
| **ååº¦** | 1 | å›¾åƒè®¡ç®— | ç°åº¦åˆ†å¸ƒååº¦ |
| **ç°åº¦å‡å€¼** | 1 | å›¾åƒè®¡ç®— | å¹³å‡ç°åº¦å¼ºåº¦ |
| **æ¸…æ™°åº¦** | 1 | å›¾åƒè®¡ç®— | æ‹‰æ™®æ‹‰æ–¯æ–¹å·®ï¼ˆé”åº¦ï¼‰ |

> **æ³¨æ„**: æ‰€æœ‰è¿ç»­ç‰¹å¾ä»…ä½¿ç”¨è®­ç»ƒé›†ç»Ÿè®¡é‡ï¼ˆå‡å€¼å’Œæ ‡å‡†å·®ï¼‰è¿›è¡Œæ ‡å‡†åŒ–ï¼Œé˜²æ­¢æ•°æ®æ³„æ¼ã€‚

## æ•°æ®é›†

- **è‚Œè‚‰éƒ¨ä½**: èƒ«éª¨å‰è‚Œ (TA)
- **å—è¯•è€…æ€»æ•°**: 1,021äºº
- **å›¾åƒæ€»æ•°**: 3,092å¼ 
- **æ•°æ®åˆ’åˆ†**: è®­ç»ƒé›† 2,225 / éªŒè¯é›† 402 / æµ‹è¯•é›† 465ï¼ˆæŒ‰å—è¯•è€…åˆ’åˆ†ï¼Œé˜²æ­¢æ³„æ¼ï¼‰
- **å¹´é¾„èŒƒå›´**: 0.0 - 88.4 å²
- **è¾…åŠ©æ•°æ®ç¼ºå¤±**: 1äºº (0.08%)

## å®éªŒé…ç½®

| å‚æ•° | å€¼ |
|------|-----|
| ä¸»å¹²ç½‘ç»œ | ResNet-50 (ImageNeté¢„è®­ç»ƒ) |
| ä¼˜åŒ–å™¨ | AdamW (lr=1e-4, weight_decay=1e-4) |
| æŸå¤±å‡½æ•° | MAE (L1 Loss) |
| å­¦ä¹ ç‡è°ƒåº¦ | CosineAnnealingLR (warmup=5è½®) |
| æ‰¹å¤§å° | 32 |
| æœ€å¤§è½®æ•° | 500 |
| æ—©åœç­–ç•¥ | è€å¿ƒå€¼100è½® |
| Dropout | 0.6 (ä¸»å¹²) / 0.36 (è¾…åŠ©åˆ†æ”¯) |
| éšæœºç§å­ | 42 (ç¡®å®šæ€§è®­ç»ƒ) |

## å®éªŒç»“æœ

### ä¸»è¦å¯¹æ¯”è¡¨

| æ’å | å®éªŒ | è¾…åŠ©ç‰¹å¾ | ç»´åº¦ | éšè—å±‚ | MAE â†“ | RMSE | æœ€ä½³è½®æ¬¡ | ç›¸æ¯”Baseline |
|:----:|------|----------|:----:|:------:|:-----:|:----:|:--------:|:------------:|
| ğŸ¥‡ **1** | `06_all_features` | æ€§åˆ«+BMI+ååº¦+ç°åº¦+æ¸…æ™°åº¦ | 6 | 32 | **6.99** | 9.49 | 168/268 | **+0.05 (+0.7%)** |
| 2 | `01_baseline` | æ— ï¼ˆä»…å›¾åƒï¼‰ | 0 | - | 7.04 | 9.25 | 132/232 | - |
| 3 | `10_all_hidden64` | æ€§åˆ«+BMI+ååº¦+ç°åº¦+æ¸…æ™°åº¦ | 6 | 64 | 7.09 | 9.56 | 21/121 | -0.05 (-0.6%) |
| 4 | `02_gender_only` | æ€§åˆ« | 2 | 32 | 7.15 | 9.77 | 180/280 | -0.11 (-1.5%) |
| 5 | `07_skewness_only` | ååº¦ | 1 | 32 | 7.17 | 9.77 | 71/171 | -0.13 (-1.9%) |
| 6 | `03_bmi_only` | BMI | 1 | 32 | 7.20 | 9.45 | 51/151 | -0.16 (-2.2%) |
| 7 | `08_clarity_only` | æ¸…æ™°åº¦ | 1 | 32 | 7.28 | 9.67 | 28/128 | -0.24 (-3.4%) |
| 8 | `05_image_stats_only` | ååº¦+ç°åº¦+æ¸…æ™°åº¦ | 3 | 32 | 7.42 | 9.89 | 36/136 | -0.38 (-5.4%) |
| 9 | `04_gender_bmi` | æ€§åˆ«+BMI | 3 | 32 | 7.43 | 10.10 | 55/155 | -0.39 (-5.5%) |
| 10 | `09_intensity_only` | ç°åº¦å‡å€¼ | 1 | 32 | 7.44 | 9.64 | 58/158 | -0.39 (-5.6%) |

### å…³é”®å‘ç°

#### 1. å…¨ç‰¹å¾èåˆè¾¾åˆ°æœ€ä½³æ€§èƒ½
- **æœ€ä½³é…ç½®**: å…¨éƒ¨6ä¸ªè¾…åŠ©ç‰¹å¾ï¼Œhidden_dim=32
- **æ€§èƒ½æå‡**: MAEä»7.04é™è‡³6.99å²ï¼ˆ**+0.7%**ï¼‰
- äººå£å­¦ç‰¹å¾å’Œå›¾åƒè¡ç”Ÿç‰¹å¾çš„ååŒç»„åˆæä¾›äº†äº’è¡¥ä¿¡æ¯

#### 2. ç‰¹å¾ååŒæ•ˆåº”è‡³å…³é‡è¦
- å•ç‹¬ä½¿ç”¨æŸä¸ªç‰¹å¾å¾€å¾€**é™ä½**æ€§èƒ½
- åªæœ‰**å…¨éƒ¨ç‰¹å¾ç»„åˆ**æ‰èƒ½è¶…è¶Šçº¯å›¾åƒåŸºçº¿
- è¿™è¡¨æ˜ç‰¹å¾ä¹‹é—´å­˜åœ¨å¤æ‚çš„äº¤äº’ä½œç”¨ï¼Œéƒ¨åˆ†ä¿¡æ¯å¯èƒ½ä¼šå¹²æ‰°æ¨¡å‹

#### 3. éšè—å±‚ç»´åº¦åˆ†æ
| éšè—ç»´åº¦ | MAE | è§‚å¯Ÿ |
|:--------:|:---:|------|
| 32 | **6.99** | æœ€ä¼˜å®¹é‡ |
| 64 | 7.09 | è½»å¾®è¿‡æ‹Ÿåˆï¼Œæ—©æœŸæ”¶æ•›ï¼ˆç¬¬21è½®ï¼‰ |

- è¾ƒå°çš„è¾…åŠ©åˆ†æ”¯ï¼ˆhidden_dim=32ï¼‰æ³›åŒ–èƒ½åŠ›æ›´å¥½
- æ›´å¤§çš„å®¹é‡å¯¼è‡´æ›´å¿«æ”¶æ•›ä½†æ³›åŒ–æ›´å·®

#### 4. å•ç‰¹å¾æ€§èƒ½åˆ†æ

```
å•ç‰¹å¾è´¡çŒ®ï¼ˆå•ç‹¬ä½¿ç”¨æ—¶ï¼‰:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ€§åˆ«       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  7.15 (-1.5%)
ååº¦       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  7.17 (-1.9%)
BMI        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  7.20 (-2.2%)
æ¸…æ™°åº¦     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  7.28 (-3.4%)
ç°åº¦å‡å€¼   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  7.44 (-5.6%)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Baseline   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  7.04 (å‚è€ƒ)
å…¨éƒ¨ç‰¹å¾   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  6.99 (+0.7%) âœ“
```

- **æ€§åˆ«**å•ç‹¬ä½¿ç”¨æ—¶è¡¨ç°æœ€å¥½
- **ç°åº¦å‡å€¼**å•ç‹¬ä½¿ç”¨æ—¶è¡¨ç°æœ€å·®
- å•ç‹¬ç‰¹å¾åœ¨ç¼ºä¹äº’è¡¥ä¿¡æ¯æ—¶ä¼šå¼•å…¥å™ªå£°

#### 5. ç‰¹å¾ç»„åˆåˆ†æ

| ç»„åˆ | ç‰¹å¾ | MAE | è§‚å¯Ÿ |
|------|------|:---:|------|
| å›¾åƒç»Ÿè®¡ | ååº¦+ç°åº¦+æ¸…æ™°åº¦ | 7.42 | ä¸è§†è§‰ç‰¹å¾å†—ä½™ |
| äººå£å­¦ | æ€§åˆ«+BMI | 7.43 | éœ€è¦å›¾åƒç»Ÿè®¡ç‰¹å¾ååŒ |
| **å…¨éƒ¨ç»„åˆ** | å…¨éƒ¨6ä¸ªç‰¹å¾ | **6.99** | ååŒæå‡ |

### æ”¶æ•›æ€§åˆ†æ

| å®éªŒ | æœ€ä½³è½®æ¬¡ | æ€»è½®æ•° | æ—©åœ | å¤‡æ³¨ |
|------|:--------:|:------:|:----:|------|
| å…¨ç‰¹å¾ (hidden=32) | 168 | 268 | âœ“ | è®­ç»ƒç¨³å®š |
| å…¨ç‰¹å¾ (hidden=64) | 21 | 121 | âœ“ | å¿«é€Ÿæ”¶æ•›ï¼Œå¯èƒ½è¿‡æ‹Ÿåˆ |
| Baseline | 132 | 232 | âœ“ | å‚è€ƒåŸºå‡† |
| ä»…æ€§åˆ« | 180 | 280 | âœ“ | æ”¹è¿›ç¼“æ…¢ |

## ç»“è®º

### æ€»ç»“
1. **å¤šæ¨¡æ€Late Fusionæä¾›è¾¹é™…ä½†ä¸€è‡´çš„æ”¹è¿›**ï¼ˆMAEé™ä½0.7%ï¼‰
2. **ç‰¹å¾ååŒæ•ˆåº”æ˜¯å…³é”®** - å•ç‹¬çš„è¾…åŠ©ç‰¹å¾åè€Œé™ä½æ€§èƒ½
3. **è¾ƒå°çš„è¾…åŠ©åˆ†æ”¯æ³›åŒ–æ›´å¥½**ï¼ˆhidden_dim=32 > 64ï¼‰
4. **å›¾åƒç‰¹å¾ä»å ä¸»å¯¼** - ResNetä¸»å¹²å·²æ•è·å¤§éƒ¨åˆ†é¢„æµ‹ä¿¡æ¯

### æ¨èé…ç½®

å®é™…éƒ¨ç½²å»ºè®®ï¼š
```bash
# æ¨èé…ç½®ï¼ˆæœ€ä½³æ€§èƒ½ï¼‰
python train.py \
  --use-aux-features \
  --aux-gender --aux-bmi \
  --aux-skewness --aux-intensity --aux-clarity \
  --aux-hidden-dim 32
```

### å±€é™æ€§
- æ”¹è¿›å¹…åº¦æœ‰é™ï¼ˆ+0.7%ï¼‰ï¼Œå¯èƒ½ä¸è¶³ä»¥è¯æ˜é¢å¤–æ•°æ®æ”¶é›†çš„æˆæœ¬
- éœ€è¦å®Œæ•´çš„è¾…åŠ©ç‰¹å¾æ•°æ®ï¼ˆç¼ºå¤±æ•°æ®æ ·æœ¬ä¼šè¢«æ’é™¤ï¼‰
- å›¾åƒè¡ç”Ÿç‰¹å¾åœ¨è§†è§‰ç‰¹å¾ä¹‹å¤–æä¾›çš„ä¿¡æ¯æœ‰é™

### æœªæ¥å·¥ä½œ
- æ¢ç´¢åŸºäºæ³¨æ„åŠ›æœºåˆ¶çš„èåˆç­–ç•¥
- ç ”ç©¶æ—©æœŸ/ä¸­é—´èåˆæ–¹æ¡ˆ
- æ·»åŠ æ›´å¤šä¸´åºŠç›¸å…³çš„è¾…åŠ©ç‰¹å¾ï¼ˆå¦‚è‚Œçº¤ç»´ç±»å‹ã€ä½“åŠ›æ´»åŠ¨æ°´å¹³ï¼‰

## å¯å¤ç°æ€§

æ‰€æœ‰å®éªŒå‡é‡‡ç”¨ç¡®å®šæ€§è®¾ç½®ï¼š
```python
torch.backends.cudnn.deterministic = True
torch.backends.cudnn.benchmark = False
torch.use_deterministic_algorithms(True, warn_only=True)
CUBLAS_WORKSPACE_CONFIG = ':4096:8'
```

å¤ç°æ­¥éª¤ï¼š
```bash
# è¿è¡Œå…¨éƒ¨æ¶ˆèå®éªŒ
bash tools/run_ablation_study.sh

# ç”Ÿæˆç»“æœæ±‡æ€»
python tools/summarize_ablation_results.py
```

## å¼•ç”¨

å¦‚æœä½¿ç”¨æœ¬å·¥ä½œï¼Œè¯·å¼•ç”¨ï¼š
```bibtex
@misc{multimodal_muscle_age,
  title={åŸºäºè¶…å£°å›¾åƒçš„éª¨éª¼è‚Œå¹´é¾„é¢„æµ‹å¤šæ¨¡æ€Late Fusionç ”ç©¶},
  year={2026},
  note={è¾…åŠ©ç‰¹å¾è´¡çŒ®çš„æ¶ˆèå®éªŒç ”ç©¶}
}
```

---

*æœ€åæ›´æ–°: 2026å¹´1æœˆ9æ—¥*  
*å®éªŒè®¾å¤‡: NVIDIA RTX 4090*
